<!DOCTYPE html>

<html>
<head>
  <title>2013-10-12</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="http://strd6.github.io/cdn/parallel/docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    <ul class="sections">
        
        
        <li id="section-1">
            <div class="annotation">
              <div class="pilwrap">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="simple-tactics">Simple Tactics</h1>

            </div>
            <div class="content"><pre><code class="lang-coffeescript">
</code></pre>
</div>
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              <div class="pilwrap">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Move duders around and have them hit one another.</p>
<h2 id="duder">Duder</h2>

            </div>
            <div class="content"><pre><code class="lang-coffeescript">
</code></pre>
</div>
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              <div class="pilwrap">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              
            </div>
            <div class="content"><pre><code class="lang-coffeescript">templates =
  duder: require <span class="string">"./duder_template"</span>

gameTemplate = require <span class="string">"./game_template"</span>

names = [
  <span class="string">"Carmack"</span>
  <span class="string">"Romero"</span>
  <span class="string">"Hall"</span>
]

enemyNames = [
  <span class="string">"Rush"</span>
  <span class="string">"Bjork"</span>
  <span class="string">"Pantera"</span>
]

<span class="function"><span class="title">alive</span></span> = (o) -&gt;
  o.I.hp &gt; <span class="number">0</span>

<span class="function"><span class="title">msg</span></span> = (msg) -&gt;
  events.push <span class="string">"<span class="subst">#{msg}</span>\n"</span>

<span class="function"><span class="title">attack</span></span> = (from, to) -&gt;
  <span class="keyword">if</span> from <span class="keyword">and</span> to
    dmg = [<span class="number">0.</span><span class="number">.1</span>].map -&gt;
      <span class="number">1.</span>d(<span class="number">6</span>) &gt; <span class="number">1.</span>d(<span class="number">6</span>)
    .sum()

    <span class="keyword">if</span> dmg &gt; <span class="number">0</span>
      msg <span class="string">"<span class="subst">#{from.name()}</span> struck <span class="subst">#{to.name()}</span> for <span class="subst">#{dmg}</span>!"</span>

      to.hp(to.hp() - dmg)
    <span class="keyword">else</span>
      msg <span class="string">"<span class="subst">#{from.name()}</span> missed <span class="subst">#{to.name()}</span>"</span>


<span class="function"><span class="title">Duder</span></span> = (I={}, self=Model(I)) -&gt;
  Object.defaults I,
    active: <span class="literal">false</span>
    enemy: <span class="literal">false</span>
    index: <span class="number">0</span>
    hp: <span class="number">3</span>
    hpMax: <span class="number">3</span>

  I.name ?= names[I.index]

  self.observeAll()

  self.<span class="function"><span class="title">click</span></span> = -&gt;
    <span class="keyword">if</span> I.enemy
      <span class="keyword">if</span> activeDuder = guys.filter (guy) -&gt;
        guy.active()
      .first()
        activeDuder.active(<span class="literal">false</span>)

        attack(activeDuder, self)

        <span class="keyword">if</span> opponent = opponents.filter(alive).first()
          <span class="keyword">if</span> target = guys.filter(alive).rand()
            attack(opponent, target)
          <span class="keyword">else</span>
            msg <span class="string">"You have been defeated!"</span>
        <span class="keyword">else</span>
          msg <span class="string">"Yo, you da winner!"</span>

    <span class="keyword">else</span>
      <span class="keyword">if</span> self.hp() &gt; <span class="number">0</span>
        self.activate()

  self.<span class="function"><span class="title">activate</span></span> = -&gt;
    guys.invoke <span class="string">"active"</span>, <span class="literal">false</span>
    self.active(<span class="literal">true</span>)

  <span class="keyword">return</span> self

opponents = [<span class="number">0.</span><span class="number">.2</span>].map (i) -&gt;
  Duder
    name: enemyNames[i]
    enemy: <span class="literal">true</span>

guys = []

guys = [<span class="number">0.</span><span class="number">.2</span>].map (i) -&gt;
  Duder
    index: i

events = Observable []

$(<span class="string">'body'</span>).append gameTemplate
  duders: guys
  opponents: opponents
  render: (template, object) -&gt;
    templates[template](object)
  events: events

$(<span class="string">'body'</span>).append $ <span class="string">"&lt;style&gt;"</span>,
  text: require(<span class="string">'./style'</span>)</code></pre>
</div>
        </li>
        
    </ul>
  </div>
  <script src="//code.jquery.com/jquery-1.10.1.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/coffee-script/1.6.3/coffee-script.min.js"></script>
<script src="http://strd6.github.io/require/v0.2.2.js"></script>
<script src="http://strd6.github.io/interactive/v0.8.0.js"></script>
<script src="http://strd6.github.io/tempest/javascripts/envweb.js"></script><script src="package.js"></script>
</body>
</html>